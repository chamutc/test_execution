<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hardware Management - Resource Scheduler</title>
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/hardware-management.css">
</head>
<body>
    <!-- Emergency Close Button -->
    <button class="emergency-close-btn" id="emergencyCloseBtn" title="Close All Modals (ESC)">‚úï</button>

    <div class="container">
        <header class="header">
            <div class="header-content">
                <h1>üîß Hardware Management</h1>
                <nav class="main-navigation">
                    <a href="sessions-management.html" class="nav-link">üìã Sessions</a>
                    <a href="index.html" class="nav-link">üìÖ Timeline</a>
                    <a href="machine-management.html" class="nav-link">üñ•Ô∏è Machine Management</a>
                    <a href="hardware-management.html" class="nav-link active">üîß Hardware Management</a>
                </nav>
            </div>
        </header>

        <main class="main-content">
            <!-- Hardware Requirements Section -->
            <section class="section">
                <div class="section-header">
                    <h2>üìã Hardware Requirements (From Sessions)</h2>
                    <div class="section-controls">
                        <button class="btn btn-info" id="syncWithSessionsBtn">üîÑ Sync with Sessions</button>
                        <button class="btn btn-secondary" id="exportRequirementsBtn">üì• Export Requirements</button>
                    </div>
                </div>

                <div class="requirements-summary" id="requirementsSummary">
                    <div class="summary-stats">
                        <div class="stat-card">
                            <div class="stat-number" id="totalSessionsRequiring">0</div>
                            <div class="stat-label">Sessions Requiring Hardware</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="uniqueHardwareCombinations">0</div>
                            <div class="stat-label">Unique Combinations</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="totalHardwareHours">0</div>
                            <div class="stat-label">Total Hardware Hours</div>
                        </div>
                    </div>
                </div>

                <div class="requirements-container">
                    <div class="requirements-table-container">
                        <table class="requirements-table" id="requirementsTable">
                            <thead>
                                <tr>
                                    <th>Platform</th>
                                    <th>Debugger</th>
                                    <th>Sessions Count</th>
                                    <th>Total Hours</th>
                                    <th>Sessions</th>
                                    <th>Inventory Status</th>
                                </tr>
                            </thead>
                            <tbody id="requirementsTableBody">
                                <!-- Requirements will be populated here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- Hardware Inventory Section -->
            <section class="section">
                <div class="section-header">
                    <h2>üì¶ Hardware Inventory (Available Stock)</h2>
                    <div class="section-controls">
                        <button class="btn btn-primary" id="addInventoryBtn">+ Add Hardware</button>
                        <button class="btn btn-success" id="autoCreateInventoryBtn">üîÑ Auto-Create from Requirements</button>
                        <button class="btn btn-info" id="inventoryAnalysisBtn">üìä Analysis</button>
                        <button class="btn btn-secondary" id="exportInventoryBtn">üì• Export Inventory</button>
                    </div>
                </div>

                <div class="inventory-container">
                    <div class="inventory-table-container">
                        <table class="inventory-table" id="inventoryTable">
                            <thead>
                                <tr>
                                    <th>Platform</th>
                                    <th>Debugger</th>
                                    <th>Available Quantity</th>
                                    <th>In Use</th>
                                    <th>Total Stock</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="inventoryTableBody">
                                <!-- Inventory will be populated here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- Hardware Availability Section -->
            <section class="section">
                <div class="section-header">
                    <h2>‚è∞ Availability Schedule</h2>
                    <div class="section-controls">
                        <button class="btn btn-success" id="bulkAvailabilityBtn">‚öôÔ∏è Bulk Edit</button>
                        <button class="btn btn-secondary" id="availabilityTemplateBtn">üìã Templates</button>
                    </div>
                </div>
                
                <div class="availability-container">
                    <div class="availability-grid" id="availabilityGrid">
                        <!-- Availability schedule will be loaded here -->
                    </div>
                </div>
            </section>

            <!-- Statistics Section -->
            <section class="section">
                <div class="section-header">
                    <h2>üìà Hardware Statistics</h2>
                </div>
                
                <div class="stats-container">
                    <div class="stats-grid" id="statsGrid">
                        <!-- Statistics will be loaded here -->
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Add Combination Modal -->
    <div class="modal-backdrop" id="addCombinationModal" style="display: none;">
        <div class="modal">
            <div class="modal-header">
                <h3>Add Hardware Combination</h3>
                <button class="modal-close" id="closeAddCombinationModal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="addCombinationForm">
                    <div class="form-group">
                        <label for="combinationName">Combination Name:</label>
                        <input type="text" id="combinationName" name="name" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="platformSelect">Platform:</label>
                        <select id="platformSelect" name="platformId" required>
                            <option value="">Select Platform...</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="debuggerSelect">Debugger:</label>
                        <select id="debuggerSelect" name="debuggerId" required>
                            <option value="">Select Debugger...</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="combinationPriority">Priority:</label>
                        <select id="combinationPriority" name="priority">
                            <option value="low">Low</option>
                            <option value="normal" selected>Normal</option>
                            <option value="high">High</option>
                            <option value="urgent">Urgent</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="combinationDescription">Description:</label>
                        <textarea id="combinationDescription" name="description" rows="3"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="combinationEnabled" name="enabled" checked>
                            Enable this combination
                        </label>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" id="cancelAddCombination">Cancel</button>
                <button type="submit" class="btn btn-primary" id="saveAddCombination">Save Combination</button>
            </div>
        </div>
    </div>

    <!-- Edit Inventory Modal -->
    <div class="modal-backdrop" id="editInventoryModal" style="display: none;">
        <div class="modal">
            <div class="modal-header">
                <h3>Edit Inventory</h3>
                <button class="modal-close" id="closeEditInventoryModal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="editInventoryForm">
                    <input type="hidden" id="inventoryId" name="id">
                    
                    <div class="form-group">
                        <label for="totalQuantity">Total Quantity:</label>
                        <input type="number" id="totalQuantity" name="totalQuantity" min="0" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="availableQuantity">Available Quantity:</label>
                        <input type="number" id="availableQuantity" name="availableQuantity" min="0" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="inventoryLocation">Location:</label>
                        <input type="text" id="inventoryLocation" name="location">
                    </div>
                    
                    <div class="form-group">
                        <label for="inventoryStatus">Status:</label>
                        <select id="inventoryStatus" name="status">
                            <option value="active">Active</option>
                            <option value="maintenance">Maintenance</option>
                            <option value="retired">Retired</option>
                        </select>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" id="cancelEditInventory">Cancel</button>
                <button type="submit" class="btn btn-primary" id="saveEditInventory">Save Changes</button>
            </div>
        </div>
    </div>

    <!-- Edit Availability Modal -->
    <div class="modal-backdrop" id="editAvailabilityModal" style="display: none;">
        <div class="modal">
            <div class="modal-header">
                <h3>Edit Availability Schedule</h3>
                <button class="modal-close" id="closeEditAvailabilityModal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="editAvailabilityForm">
                    <input type="hidden" id="availabilityId" name="id">
                    <input type="hidden" id="availabilityCombinationId" name="hardwareCombinationId">
                    
                    <div class="form-group">
                        <label for="dayOfWeek">Day of Week:</label>
                        <select id="dayOfWeek" name="dayOfWeek" required>
                            <option value="0">Sunday</option>
                            <option value="1">Monday</option>
                            <option value="2">Tuesday</option>
                            <option value="3">Wednesday</option>
                            <option value="4">Thursday</option>
                            <option value="5">Friday</option>
                            <option value="6">Saturday</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="startHour">Start Hour:</label>
                        <input type="number" id="startHour" name="startHour" min="0" max="23" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="endHour">End Hour:</label>
                        <input type="number" id="endHour" name="endHour" min="1" max="24" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="maxConcurrentUsage">Max Concurrent Usage:</label>
                        <input type="number" id="maxConcurrentUsage" name="maxConcurrentUsage" min="1" required>
                    </div>
                    
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="availabilityEnabled" name="enabled">
                            Enable this time slot
                        </label>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" id="cancelEditAvailability">Cancel</button>
                <button type="submit" class="btn btn-primary" id="saveEditAvailability">Save Changes</button>
            </div>
        </div>
    </div>

    <!-- Notification Container -->
    <div id="notificationContainer"></div>

    <!-- Scripts -->
    <script src="js/comprehensiveHardwareManager.js"></script>
    <script>
        // Initialize comprehensive hardware manager when page loads
        document.addEventListener('DOMContentLoaded', () => {
            window.comprehensiveHardwareManager = new ComprehensiveHardwareManager();

            // Handle Sessions navigation
            const sessionsLink = document.querySelector('a[href="index.html#sessions"]');
            if (sessionsLink) {
                sessionsLink.addEventListener('click', (e) => {
                    e.preventDefault();
                    window.location.href = 'index.html#sessions';
                    // The main page will handle showing the sessions section
                });
            }

            // Emergency close button
            const emergencyCloseBtn = document.getElementById('emergencyCloseBtn');
            if (emergencyCloseBtn) {
                emergencyCloseBtn.addEventListener('click', () => {
                    // Close all modals
                    const modals = document.querySelectorAll('.modal-backdrop');
                    modals.forEach(modal => modal.remove());

                    const visibleModals = document.querySelectorAll('.modal');
                    visibleModals.forEach(modal => modal.style.display = 'none');

                    emergencyCloseBtn.classList.remove('show');
                });
            }

            // ESC key handler
            document.addEventListener('keydown', (event) => {
                if (event.key === 'Escape') {
                    const emergencyBtn = document.getElementById('emergencyCloseBtn');
                    if (emergencyBtn) {
                        emergencyBtn.click();
                    }
                }
            });
        });
    </script>
</body>
</html>
